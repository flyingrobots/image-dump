FROM node:20-alpine

WORKDIR /app


# Copy package files
COPY package*.json ./

# Install dependencies (including dev dependencies for linting)
# Use cache mount to speed up rebuilds
RUN --mount=type=cache,target=/root/.npm \
    npm ci

# Copy eslint config
COPY eslint.config.js ./

# We don't copy source code here - it's bind mounted at runtime
# This way the image only needs rebuilding when package.json or .eslintrc.js changes

# Default command runs lint
CMD ["npm", "run", "lint"]